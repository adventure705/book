<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í„°ì§€ëŠ” ê¸°ìŠ¹ì „ê²° êµ¬ì¡° 10ì„  - ì¸í„°ë™í‹°ë¸Œ ë©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #fdfbf7; /* Warm neutral background */
            color: #2d3748;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 350px;
            margin: 0 auto;
        }

        @media (max-width: 640px) {
            .chart-container {
                height: 300px;
            }
        }

        .step-card {
            transition: all 0.3s ease;
        }
        
        .step-card:hover {
            transform: translateY(-2px);
        }

        .structure-card {
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .structure-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .structure-card.active {
            border-color: #d97706; /* Amber-600 */
            background-color: #fffbeb; /* Amber-50 */
        }

        /* Custom Scrollbar for the list */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Base: #fdfbf7) with Amber/Orange accents for energy and Slate for text. 
         Rationale: Creates a calm, reading-focused environment while highlighting the "explosive" nature of the content with warm accents. -->
    
    <!-- Application Structure Plan: 
         1. Hero Section: Clear title and purpose.
         2. Main Workspace (Split View): 
            - Top/Left: "Analysis Lab" showing the details of the CURRENTLY selected structure (Flow + Chart).
            - Bottom/Right: "Library" grid of all 10 structures for navigation.
         3. Interactions:
            - Filtering the grid by category (Twist, Survival, Info).
            - Clicking a card updates the Analysis Lab immediately.
            - Visual Step Flow: Clearly delineates Ki-Seung-Jeon-Kyeol.
         Rationale: This Master-Detail view allows users to browse the collection while maintaining focus on studying one structure at a time. 
    -->

    <!-- Visualization & Content Choices:
         1. Radar Chart: To visualize the abstract "feel" of each story structure (Tension, Utility, Twist, Empathy, Shock). 
            - Goal: Compare. 
            - Interaction: Updates on card click.
         2. Step-by-Step Flow: Visual vertical/horizontal timeline for Ki-Seung-Jeon-Kyeol.
            - Goal: Inform/Organize.
            - Justification: Text alone is hard to parse; spatial arrangement shows progression.
         3. Filter Tags: Quick buttons to sort the 10 items.
            - Goal: Organize.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-10 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <span class="text-3xl">ğŸ’¥</span>
                <div>
                    <h1 class="text-xl font-bold text-gray-900 leading-tight">í„°ì§€ëŠ” ê¸°ìŠ¹ì „ê²° êµ¬ì¡° 10ì„ </h1>
                    <p class="text-sm text-gray-500">ì½˜í…ì¸  í¡ì…ë ¥ ê°•í™” íŒ¨í„´ ë¶„ì„ ë©</p>
                </div>
            </div>
            <button id="reset-btn" class="text-sm text-gray-500 hover:text-amber-600 underline hidden sm:block">ì´ˆê¸°í™”</button>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full flex flex-col lg:flex-row gap-8">
        
        <!-- Left Column: The Analysis Lab (Detail View) -->
        <section class="w-full lg:w-5/12 xl:w-1/3 flex flex-col gap-6 order-1 lg:order-2 lg:sticky lg:top-24 h-fit">
            
            <!-- Intro Box -->
            <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
                <h2 class="text-lg font-semibold mb-2 text-gray-800">ğŸ“Š êµ¬ì¡° ë¶„ì„ì‹¤</h2>
                <p class="text-sm text-gray-600 mb-4">
                    ì•„ë˜ ë¦¬ìŠ¤íŠ¸ì—ì„œ êµ¬ì¡°ë¥¼ ì„ íƒí•˜ë©´ ìƒì„¸ íë¦„ê³¼ 
                    <span class="font-bold text-amber-600">ì½˜í…ì¸  DNA(íŠ¹ì§•)</span>ë¥¼ ë¶„ì„í•´ ë“œë¦½ë‹ˆë‹¤.
                    ë‚´ ì†Œì¬ì— ë§ëŠ” ìµœì ì˜ í”„ë ˆì„ì›Œí¬ë¥¼ ì°¾ì•„ë³´ì„¸ìš”.
                </p>
            </div>

            <!-- Detail Display Area -->
            <div id="detail-view" class="bg-white rounded-xl shadow-lg border border-amber-100 overflow-hidden transition-all duration-300">
                <!-- Header of Detail -->
                <div class="bg-amber-50 p-6 border-b border-amber-100">
                    <div class="flex justify-between items-start mb-2">
                        <span id="detail-id" class="text-xs font-bold bg-amber-200 text-amber-800 px-2 py-1 rounded">NO. 001</span>
                        <span id="detail-icon" class="text-3xl">ğŸ’°</span>
                    </div>
                    <h2 id="detail-title" class="text-2xl font-bold text-gray-900 mb-1">ìš•ë§ í­ë°œí˜•</h2>
                    <p id="detail-features" class="text-sm text-gray-600 italic">ìš•ë§ + ë°˜ì „ + ìœ ë¨¸</p>
                </div>

                <!-- Radar Chart -->
                <div class="p-6 bg-white">
                    <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 text-center">Structural DNA Analysis</h3>
                    <div class="chart-container">
                        <canvas id="structureRadar"></canvas>
                    </div>
                </div>

                <!-- Story Flow Timeline -->
                <div class="p-6 bg-gray-50 border-t border-gray-100">
                    <h3 class="text-sm font-bold text-gray-700 mb-4 flex items-center">
                        <span class="mr-2">ğŸ“</span> ì „ê°œ íë¦„ (Flow)
                    </h3>
                    <div class="space-y-4 relative">
                        <!-- Connecting Line -->
                        <div class="absolute left-3.5 top-2 bottom-4 w-0.5 bg-gray-200 -z-10"></div>

                        <!-- Ki -->
                        <div class="flex items-start group">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-bold border-2 border-white shadow-sm z-0">ê¸°</div>
                            <div class="ml-4 flex-grow">
                                <span class="text-xs text-blue-600 font-bold block mb-0.5">ë¬¸ì œ ì œê¸°</span>
                                <p id="detail-ki" class="text-sm text-gray-700 bg-white p-3 rounded-lg shadow-sm border border-gray-100">ìê·¹ì ì¸ ìš•ë§ ì œì‹œ (ëˆ/ì„±/ê¶Œë ¥ ë“±)</p>
                            </div>
                        </div>

                        <!-- Seung -->
                        <div class="flex items-start group">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center text-xs font-bold border-2 border-white shadow-sm z-0">ìŠ¹</div>
                            <div class="ml-4 flex-grow">
                                <span class="text-xs text-yellow-600 font-bold block mb-0.5">ì˜ˆìƒ ë°– ì „ê°œ</span>
                                <p id="detail-seung" class="text-sm text-gray-700 bg-white p-3 rounded-lg shadow-sm border border-gray-100">ì ì  ìˆ˜ìƒí•œ íë¦„</p>
                            </div>
                        </div>

                        <!-- Jeon -->
                        <div class="flex items-start group">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center text-xs font-bold border-2 border-white shadow-sm z-0">ì „</div>
                            <div class="ml-4 flex-grow">
                                <span class="text-xs text-red-600 font-bold block mb-0.5">ëª°ì…/ê¸´ì¥</span>
                                <p id="detail-jeon" class="text-sm text-gray-700 bg-white p-3 rounded-lg shadow-sm border border-gray-100 font-medium">ê°‘ì‘ìŠ¤ëŸ¬ìš´ ë°˜ì „ ìƒí™©</p>
                            </div>
                        </div>

                        <!-- Kyeol -->
                        <div class="flex items-start group">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xs font-bold border-2 border-white shadow-sm z-0">ê²°</div>
                            <div class="ml-4 flex-grow">
                                <span class="text-xs text-green-600 font-bold block mb-0.5">ê²°ë¡ /ì¸ì‚¬ì´íŠ¸</span>
                                <p id="detail-kyeol" class="text-sm text-gray-700 bg-white p-3 rounded-lg shadow-sm border border-gray-100">í—ˆë¬´ or ë°˜ì „ ê²°ë§</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Right Column: The Library (Grid List) -->
        <section class="w-full lg:w-7/12 xl:w-2/3 order-2 lg:order-1">
            
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">êµ¬ì¡° ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>
                <p class="text-gray-600 mb-4 text-sm sm:text-base">ì›í•˜ëŠ” ì½˜í…ì¸  ì„±ê²©ì— ë§ëŠ” í•„í„°ë¥¼ ì„ íƒí•˜ì—¬ êµ¬ì¡°ë¥¼ íƒìƒ‰í•˜ì„¸ìš”.</p>
                
                <!-- Filters -->
                <div class="flex flex-col gap-4" id="filter-container">
                    
                    <!-- 1. Major Category Filters (ëŒ€ë¶„ë¥˜) -->
                    <div class="flex flex-wrap gap-2">
                        <button class="filter-btn active px-4 py-2 rounded-full text-sm font-medium transition-colors bg-gray-800 text-white hover:bg-gray-700" data-filter="all">ì „ì²´ ë³´ê¸°</button>
                        <button class="filter-btn px-4 py-2 rounded-full text-sm font-medium transition-colors bg-white text-gray-600 border border-gray-200 hover:border-pink-500 hover:text-pink-600" data-filter="emotion-category">â¤ï¸ ê°ì • ëª°ì…í˜•</button>
                        <button class="filter-btn px-4 py-2 rounded-full text-sm font-medium transition-colors bg-white text-gray-600 border border-gray-200 hover:border-teal-500 hover:text-teal-600" data-filter="info-category">ğŸ“š ì •ë³´ ì „ë‹¬í˜•</button>
                    </div>

                    <!-- 2. Fine-Grained Filters (ë¯¸ì„¸ í•„í„°) -->
                    <div class="flex flex-wrap gap-2">
                        <button class="filter-btn px-4 py-2 rounded-full text-sm font-medium transition-colors bg-white text-gray-600 border border-gray-200 hover:border-amber-500 hover:text-amber-600" data-filter="twist">ğŸŒ€ ë°˜ì „/ì¶©ê²©</button>
                        <button class="filter-btn px-4 py-2 rounded-full text-sm font-medium transition-colors bg-white text-gray-600 border border-gray-200 hover:border-blue-500 hover:text-blue-600" data-filter="info">ğŸ’¡ ì •ë³´/ì‹¤ìš©</button>
                        <button class="filter-btn px-4 py-2 rounded-full text-sm font-medium transition-colors bg-white text-gray-600 border border-gray-200 hover:border-red-500 hover:text-red-600" data-filter="tension">ğŸ”¥ ê¸´ì¥/ê³µí¬</button>
                        <button class="filter-btn px-4 py-2 rounded-full text-sm font-medium transition-colors bg-white text-gray-600 border border-gray-200 hover:border-green-500 hover:text-green-600" data-filter="emotion">ğŸ’– ê³µê°/ê°ë™</button>
                    </div>
                </div>
            </div>

            <!-- Grid -->
            <div id="grid-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Cards will be injected here via JS -->
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-gray-300 py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-sm">ë°ì´í„° ì¶œì²˜: í„°ì§€ëŠ” ê¸°ìŠ¹ì „ê²° êµ¬ì¡° 10ì„  ë¦¬í¬íŠ¸</p>
            <p class="text-xs text-gray-500 mt-2">Â© 2025 Interactive Storytelling Lab.</p>
        </div>
    </footer>

    <script>
        // --- DATA SOURCE ---
        const storyStructures = [
            {
                id: '001',
                name: 'ìš•ë§ í­ë°œí˜•',
                icon: 'ğŸ’°',
                ki: 'ìê·¹ì ì¸ ìš•ë§ ì œì‹œ (ëˆ/ì„±/ê¶Œë ¥ ë“±)',
                seung: 'ì ì  ìˆ˜ìƒí•œ íë¦„',
                jeon: 'ê°‘ì‘ìŠ¤ëŸ¬ìš´ ë°˜ì „ ìƒí™©',
                kyeol: 'í—ˆë¬´ or ë°˜ì „ ê²°ë§',
                features: 'ìš•ë§ + ë°˜ì „ + ìœ ë¨¸',
                tags: ['twist', 'tension'],
                category: 'emotion', /* New Category: emotion */
                metrics: { tension: 8, utility: 2, twist: 10, empathy: 3, horror: 5 }
            },
            {
                id: '002',
                name: 'ì¼ìƒ ì† ê¿€íŒí˜•',
                icon: 'ğŸ’¡',
                ki: 'ì¼ìƒì ì¸ ìƒí™©ì˜ ì‹œì‘',
                seung: 'ì¼ë°˜ê³¼ ë‹¤ë¥¸ í•´ê²° ì‹œë„',
                jeon: 'ë‚¯ì„  ê³¼ì •Â·ê¸°ìˆ  ë“±ì¥',
                kyeol: 'ì‹¤ìš© ê¿€íŒ or ë†€ë¼ìš´ ì •ë¦¬',
                features: 'ì‹¤ìš© + íŒ + ê³µê°',
                tags: ['info', 'emotion'],
                category: 'info', /* New Category: info */
                metrics: { tension: 2, utility: 10, twist: 4, empathy: 9, horror: 0 }
            },
            {
                id: '003',
                name: 'ê·¹í•œ ìƒì¡´ ê²½ê³ í˜•',
                icon: 'ğŸš¨',
                ki: 'ìœ„í—˜í•˜ê±°ë‚˜ ìœ„íƒœë¡œìš´ ìƒí™© ì§„ì…',
                seung: 'ì ì  ì‹¬í•´ì§€ëŠ” ë„ì „',
                jeon: 'ì‹¤ì œ ìœ„ê¸° or ì‹¤íŒ¨ ìœ„í˜‘',
                kyeol: 'ìƒì¡´ë²• or ì‹¤íŒ¨ ì‚¬ë¡€',
                features: 'ìƒì¡´ + ëª°ì… + ê²½ê³ ',
                tags: ['tension', 'info'],
                category: 'emotion', /* New Category: emotion */
                metrics: { tension: 10, utility: 8, twist: 3, empathy: 5, horror: 7 }
            },
            {
                id: '004',
                name: 'í¸ê²¬ íƒ€íŒŒí˜•',
                icon: 'ğŸŒ',
                ki: 'ë¬¸í™”ì  ì˜¤í•´ ë˜ëŠ” ì¶©ëŒ',
                seung: 'íƒ€ ë¬¸í™” ê´€ìŠµ ë“±ì¥',
                jeon: 'ì´í•´ ê³¼ì •ì—ì„œ í¸ê²¬ ê¹¨ì§',
                kyeol: 'ì¸ì‚¬ì´íŠ¸ or ê°ë™ ê²°ë¡ ',
                features: 'ë¬¸í™” + ì¸ì‹ ì „í™˜',
                tags: ['emotion', 'info'],
                category: 'info', /* New Category: info (Changed based on user's image classification) */
                metrics: { tension: 4, utility: 6, twist: 6, empathy: 10, horror: 1 }
            },
            {
                id: '005',
                name: 'êµ¬ì¡°ë¬¼ ë¯¸ìŠ¤í„°ë¦¬í˜•',
                icon: 'âš™ï¸',
                ki: 'ë¹„ì •ìƒì  í–‰ë™ or ì´ìƒí•œ êµ¬ì¡° ë…¸ì¶œ',
                seung: 'êµ¬ì¡° or ì›ì¸ ë¶„ì„',
                jeon: 'ëª°ì…ë˜ëŠ” ê³¼ì • or ì‹œê° ë³€í™”',
                kyeol: 'ê²°êµ­ ë†€ë¼ìš´ ì§„ì‹¤ ë°œê²¬',
                features: 'ê±´ì¶•/ê¸°ê³„ + ë°˜ì „',
                tags: ['twist', 'tension'],
                category: 'info', /* New Category: info (Changed based on user's image classification) */
                metrics: { tension: 7, utility: 4, twist: 9, empathy: 2, horror: 4 }
            },
            {
                id: '006',
                name: 'ì‹¤ì²´ í­ë¡œí˜•',
                icon: 'ğŸ›¡ï¸',
                ki: 'ê²‰ë³´ê¸°ì—” ë©€ì©¡í•œ ëŒ€ìƒ',
                seung: 'ì† ë‚´ìš© íŒŒí—¤ì¹˜ê¸°',
                jeon: 'ì¶©ê²©ì ì¸ ì‹¤ì²´ ë°œê²¬',
                kyeol: 'ì§„ì‹¤ or ì†Œë¹„ì ê²½ê³ ',
                features: 'ì‚¬ê¸° + ì†Œë¹„ì ì •ë³´',
                tags: ['info', 'twist'],
                category: 'emotion', /* New Category: emotion (Changed based on user's image classification) */
                metrics: { tension: 6, utility: 9, twist: 8, empathy: 6, horror: 2 }
            },
            {
                id: '007',
                name: 'ë¶ˆê°€ëŠ¥ ë„ì „í˜•',
                icon: 'ğŸš€',
                ki: 'ë„ì €íˆ ì„±ê³µ ëª»í•  ë¯¸ì…˜ ì œì‹œ',
                seung: 'ì´ìƒí•œ ë°©ì‹ìœ¼ë¡œ ë„ì „',
                jeon: 'ì ì  ê·¹í•œì— ëª°ë¦¬ëŠ” ìƒí™©',
                kyeol: 'ì„±ê³µ or ì‹¤íŒ¨ í†µí•œ êµí›ˆ',
                features: 'ëª°ì… + ê°ì • + ë„ì „',
                tags: ['tension', 'emotion'],
                category: 'info', /* New Category: info (Changed based on user's image classification) */
                metrics: { tension: 9, utility: 3, twist: 5, empathy: 8, horror: 3 }
            },
            {
                id: '008',
                name: 'ìì—° ê·¹í•œ ìƒì¡´í˜•',
                icon: 'ğŸŒ¿',
                ki: 'ìì—° ì† ê·¹í•œ ìƒí™© ì—°ì¶œ',
                seung: 'ì‚´ì•„ë‚¨ê¸° ìœ„í•œ ì‹œë„',
                jeon: 'ì˜ì™¸ì˜ ë³€ìˆ˜ ë“±ì¥',
                kyeol: 'ì‹¤ì œ ìƒì¡´ ê¸°ìˆ  ê³µìœ ',
                features: 'ìì—° + ê¸´ì¥ + ì‹¤ìš©',
                tags: ['tension', 'info'],
                category: 'info', /* New Category: info */
                metrics: { tension: 9, utility: 9, twist: 4, empathy: 4, horror: 6 }
            },
            {
                id: '009',
                name: 'ì¥ì†Œ ë¯¸ìŠ¤í„°ë¦¬ ê³µí¬í˜•',
                icon: 'ğŸ‘»',
                ki: 'í”í•œ ì¥ì†Œ or êµ¬ì¡°ë¬¼ ì†Œê°œ',
                seung: 'ì´ìƒí•œ ë””í…Œì¼ í¬ì°©',
                jeon: 'ê¹Šì´ ë“¤ì–´ê°ˆìˆ˜ë¡ ë¶ˆì•ˆ ì¦í­',
                kyeol: 'ë¶•ê´´ or ì¶©ê²© ê²°ë§',
                features: 'ìœ„ê¸° + êµ¬ì¡°ë¬¼ + ê³µí¬',
                tags: ['tension', 'twist'],
                category: 'emotion', /* New Category: emotion */
                metrics: { tension: 10, utility: 1, twist: 8, empathy: 2, horror: 10 }
            },
            {
                id: '010',
                name: 'ì§„ì‹¤ ê²€ì¦ ë°˜ì „í˜•',
                icon: 'âš–ï¸',
                ki: 'â€˜ì§„ì§œì¼ê¹Œ?â€™ë¼ëŠ” ì˜ì‹¬ ìœ ë„',
                seung: 'ì‹¤í—˜ or ë¶„ì„ìœ¼ë¡œ ì¦ëª…',
                jeon: 'ë°˜ì „ì´ ë“œëŸ¬ë‚˜ëŠ” ìˆœê°„',
                kyeol: 'í—ˆì„¸ vs ì‹¤ì† ì •ë¦¬',
                features: 'ê³¼ì¥ ê´‘ê³  + ë°˜ì „ ë¹„êµ',
                tags: ['twist', 'info'],
                category: 'info', /* New Category: info */
                metrics: { tension: 5, utility: 8, twist: 9, empathy: 5, horror: 0 }
            }
        ];

        // --- STATE & VARIABLES ---
        let currentStructure = storyStructures[0];
        let currentFilter = 'all';
        let radarChart = null;

        // --- DOM ELEMENTS ---
        const gridContainer = document.getElementById('grid-container');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const resetBtn = document.getElementById('reset-btn');

        // Detail Elements
        const detailId = document.getElementById('detail-id');
        const detailIcon = document.getElementById('detail-icon');
        const detailTitle = document.getElementById('detail-title');
        const detailFeatures = document.getElementById('detail-features');
        const detailKi = document.getElementById('detail-ki');
        const detailSeung = document.getElementById('detail-seung');
        const detailJeon = document.getElementById('detail-jeon');
        const detailKyeol = document.getElementById('detail-kyeol');

        // --- FUNCTIONS ---

        // 1. Initialize Chart
        function initChart() {
            const ctx = document.getElementById('structureRadar').getContext('2d');
            
            // Register plugin to draw background color if needed, but Chart.js radar has fill
            
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['ê¸´ì¥ê° (Tension)', 'ì‹¤ìš©ì„± (Utility)', 'ë°˜ì „ (Twist)', 'ê³µê° (Empathy)', 'ìê·¹/ê³µí¬ (Stimulation)'],
                    datasets: [{
                        label: 'ì½˜í…ì¸  ì„±í–¥ ë¶„ì„',
                        data: [0, 0, 0, 0, 0], // Initial dummy data
                        backgroundColor: 'rgba(217, 119, 6, 0.2)', // Amber-600 with opacity
                        borderColor: 'rgba(217, 119, 6, 1)',
                        pointBackgroundColor: 'rgba(217, 119, 6, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(217, 119, 6, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            suggestedMin: 0,
                            suggestedMax: 10,
                            ticks: {
                                stepSize: 2,
                                backdropColor: 'transparent',
                                display: false // Hide numbers for cleaner look
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            pointLabels: {
                                font: {
                                    size: 12,
                                    family: "'Noto Sans KR', sans-serif",
                                    weight: 'bold'
                                },
                                color: '#4b5563'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 10,
                            cornerRadius: 4,
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '/10';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 2. Update Detail View
        function updateDetail(structure) {
            currentStructure = structure;
            
            // Animate transition (simple opacity fade effect logic could be added here, doing direct replacement for responsiveness)
            
            // Text Content
            detailId.textContent = `NO. ${structure.id}`;
            detailIcon.textContent = structure.icon;
            detailTitle.textContent = structure.name;
            detailFeatures.textContent = structure.features;
            
            detailKi.textContent = structure.ki;
            detailSeung.textContent = structure.seung;
            detailJeon.textContent = structure.jeon;
            detailKyeol.textContent = structure.kyeol;

            // Highlight Active Card
            document.querySelectorAll('.structure-card').forEach(card => {
                if(card.dataset.id === structure.id) {
                    card.classList.add('active', 'border-amber-500', 'ring-2', 'ring-amber-200');
                    card.classList.remove('border-transparent');
                } else {
                    card.classList.remove('active', 'border-amber-500', 'ring-2', 'ring-amber-200');
                    card.classList.add('border-transparent');
                }
            });

            // Update Chart
            if (radarChart) {
                radarChart.data.datasets[0].data = [
                    structure.metrics.tension,
                    structure.metrics.utility,
                    structure.metrics.twist,
                    structure.metrics.empathy,
                    structure.metrics.horror
                ];
                radarChart.update();
            }
            
            // Scroll to top on mobile only if needed (optional)
            if (window.innerWidth < 1024) {
                 // document.getElementById('detail-view').scrollIntoView({ behavior: 'smooth' });
            }
        }

        // 3. Render Grid
        function renderGrid(filter = 'all') {
            gridContainer.innerHTML = '';
            
            let filteredData;

            if (filter === 'all') {
                filteredData = storyStructures;
            } else if (filter === 'emotion-category' || filter === 'info-category') {
                const category = filter.split('-')[0];
                filteredData = storyStructures.filter(s => s.category === category);
            } else { // Existing tags (twist, info, tension, emotion)
                filteredData = storyStructures.filter(s => s.tags.includes(filter));
            }

            if (filteredData.length === 0) {
                gridContainer.innerHTML = '<div class="col-span-full text-center py-10 text-gray-500">í•´ë‹¹í•˜ëŠ” êµ¬ì¡°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            filteredData.forEach(item => {
                const card = document.createElement('div');
                card.className = `structure-card bg-white p-5 rounded-lg shadow-sm border border-transparent hover:border-amber-300 relative`;
                card.dataset.id = item.id;
                
                // Active state check
                if (item.id === currentStructure.id) {
                    card.classList.add('active', 'border-amber-500', 'ring-2', 'ring-amber-200');
                    card.classList.remove('border-transparent');
                }

                card.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">${item.icon}</span>
                            <div>
                                <span class="text-xs font-bold text-gray-400">NO. ${item.id}</span>
                                <h3 class="font-bold text-gray-800 text-lg leading-none">${item.name}</h3>
                            </div>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 line-clamp-2 mb-3 h-10">${item.features}</p>
                    <div class="flex gap-1 flex-wrap">
                         <span class="text-xs px-2 py-1 rounded-full ${item.category === 'emotion' ? 'bg-pink-100 text-pink-700' : 'bg-teal-100 text-teal-700'}">#${item.category === 'emotion' ? 'ê°ì •ëª°ì…' : 'ì •ë³´ì „ë‹¬'}</span>
                         ${item.tags.map(tag => {
                             let colorClass = 'bg-gray-100 text-gray-600';
                             if(tag === 'twist') colorClass = 'bg-purple-50 text-purple-600';
                             if(tag === 'info') colorClass = 'bg-blue-50 text-blue-600';
                             if(tag === 'tension') colorClass = 'bg-red-50 text-red-600';
                             if(tag === 'emotion') colorClass = 'bg-green-50 text-green-600';
                             return `<span class="text-xs px-2 py-1 rounded-full ${colorClass}">#${getTagLabel(tag)}</span>`
                         }).join('')}
                    </div>
                `;

                card.addEventListener('click', () => updateDetail(item));
                gridContainer.appendChild(card);
            });
        }

        // Helper for tags
        function getTagLabel(tag) {
            const labels = {
                twist: 'ë°˜ì „',
                info: 'ì •ë³´',
                tension: 'ê¸´ì¥',
                emotion: 'ê°ë™'
            };
            return labels[tag] || tag;
        }

        // 4. Filter Logic
        filterBtns.forEach(btn => {
            btn.addEventListener('click', (e) => {
                // UI Update for ALL buttons
                filterBtns.forEach(b => {
                    b.classList.remove('bg-gray-800', 'text-white');
                    b.classList.add('bg-white', 'text-gray-600');
                    // Remove specific hover styles for active state
                    b.classList.remove('hover:border-pink-500', 'hover:text-pink-600', 'hover:border-teal-500', 'hover:text-teal-600', 'hover:border-amber-500', 'hover:text-amber-600', 'hover:border-blue-500', 'hover:text-blue-600', 'hover:border-red-500', 'hover:text-red-600', 'hover:border-green-500', 'hover:text-green-600');
                    if (b.dataset.filter === 'emotion-category') b.classList.add('hover:border-pink-500', 'hover:text-pink-600');
                    else if (b.dataset.filter === 'info-category') b.classList.add('hover:border-teal-500', 'hover:text-teal-600');
                    else if (b.dataset.filter === 'twist') b.classList.add('hover:border-amber-500', 'hover:text-amber-600');
                    else if (b.dataset.filter === 'info') b.classList.add('hover:border-blue-500', 'hover:text-blue-600');
                    else if (b.dataset.filter === 'tension') b.classList.add('hover:border-red-500', 'hover:text-red-600');
                    else if (b.dataset.filter === 'emotion') b.classList.add('hover:border-green-500', 'hover:text-green-600');
                    else if (b.dataset.filter === 'all') b.classList.add('hover:bg-gray-700');
                });
                
                // Set active style
                e.target.classList.remove('bg-white', 'text-gray-600');
                e.target.classList.add('bg-gray-800', 'text-white');

                // Logic Update
                currentFilter = e.target.dataset.filter;
                renderGrid(currentFilter);
            });
        });

        // 5. Reset
        if(resetBtn) {
            resetBtn.addEventListener('click', () => {
                currentFilter = 'all';
                updateDetail(storyStructures[0]);
                
                // Reset buttons UI
                filterBtns.forEach(b => {
                    b.classList.remove('bg-gray-800', 'text-white');
                    b.classList.add('bg-white', 'text-gray-600');
                    
                    if (b.dataset.filter === 'all') {
                        b.classList.add('bg-gray-800', 'text-white');
                        b.classList.remove('bg-white', 'text-gray-600');
                    }
                });
                
                renderGrid('all');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // --- INIT ---
        window.addEventListener('DOMContentLoaded', () => {
            initChart();
            renderGrid();
            updateDetail(storyStructures[0]); // Load first item
        });

    </script>
</body>
</html>